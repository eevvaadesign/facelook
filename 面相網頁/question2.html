<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¬¬äºŒé¡Œ</title>
    <style>
         body, html {
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background: url('images/background(2).png') no-repeat center center;
            background-size: 1125px 2436px;
        }
        .container {
            display: flex;
            width: 80%;
            height: 70vh;
        }
        .left-box {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 790px;
            height: 1034px;
            transform: translate(-50%, -50%) translate(-138px, -535px);
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .right-options {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 246px;
            height: 1831px;
            max-height: 80vh;
            overflow-y: auto;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px 0;
            transform: translate(-50%, -50%) translate(410px, -120px);
        }
         /* è‡ªè¨‚æ»¾å‹•æ¢æ¨£å¼ */
         .right-options::-webkit-scrollbar {
            width: 7px; /* èª¿æ•´æ»¾å‹•æ¢å¯¬åº¦ */
        }
        .right-options::-webkit-scrollbar-thumb {
            background-color: rgba(0, 0, 0, 0.5); /* æ»¾å‹•æ¢é¡è‰² */
            border-radius: 4px;
        }
    
        .right-options.hidden {
            display: none;
        }

        
        .option img {
            width: 190px;
            height: auto;
            cursor: pointer;
            border: 2px solid transparent;
            margin-bottom: 150px;
        }
        .option img:hover {
            border-color: #000;
        }
        .control-panel {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 790px;
            height: 550px;
            transform: translate(-50%, -50%) translate(-138px, 400px);
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 20px;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .control-group button {
            width: 60px;
            height: 60px;
            font-size: 24px;
            cursor: pointer;
            margin: 5px;
        }
        .control-group span {
            font-size: 20px;
            font-weight: bold;
        }

        .next-button {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 300px;
      height: 300px;
      background-color: transparent; /* è¨­ç‚ºé€æ˜ */
      border: none; /* ç§»é™¤é‚Šæ¡† */
      display: block;
      cursor: pointer;
      transform: translate(250px, 870px);
       }

    </style>
</head>
<body>
    <div class="container">
        <div class="left-box" id="displayBox"></div>
    </div>

    <!-- å³å´é¸é …æ¬„ -->
    <div class="right-options" id="optionsContainer">
        <div class="option" onclick="selectBrow('images/brow1.png')">
            <img src="images/brow1.png" alt="é¸é …1">
        </div>
        <div class="option" onclick="selectBrow('images/brow2.png')">
            <img src="images/brow2.png" alt="é¸é …2">
        </div>
        <div class="option" onclick="selectBrow('images/brow3.png')">
            <img src="images/brow3.png" alt="é¸é …3">
        </div>
        <div class="option" onclick="selectBrow('images/brow4.png')">
            <img src="images/brow4.png" alt="é¸é …4">
        </div>
        <div class="option" onclick="selectBrow('images/brow5.png')">
            <img src="images/brow5.png" alt="é¸é …5">
        </div>
        <div class="option" onclick="selectBrow('images/brow6.png')">
            <img src="images/brow6.png" alt="é¸é …6">
        </div>
        <div class="option" onclick="selectBrow('images/brow7.png')">
            <img src="images/brow7.png" alt="é¸é …7">
        </div>
        <div class="option" onclick="selectBrow('images/brow8.png')">
            <img src="images/brow8.png" alt="é¸é …8">
        </div>
        <div class="option" onclick="selectBrow('images/brow9.png')">
            <img src="images/brow9.png" alt="é¸é …9">
        </div>
    </div>

<div class="control-panel">
    <div class="control-group">
        <button onclick="adjustBrow('rotate', -5)">ğŸ”¼</button>
        <span>è§’åº¦</span>
        <button onclick="adjustBrow('rotate', 5)">ğŸ”½</button>
    </div>
    <div class="control-group">
        <button onclick="adjustBrow('vertical', -10)">ğŸ”¼</button>
        <span>ä¸Šä¸‹</span>
        <button onclick="adjustBrow('vertical', 10)">ğŸ”½</button>
    </div>
    <div class="control-group">
        <button onclick="adjustBrow('horizontal', -10)">ğŸ”¼</button>
        <span>å·¦å³</span>
        <button onclick="adjustBrow('horizontal', 10)">ğŸ”½</button>
    </div>
</div>
<div class="control-group">
    <button onclick="resetBrow()">ğŸ”„</button>
    <span>é‚„åŸ</span>
    <!-- ä¸‹ä¸€é æŒ‰éˆ• -->
    <div class="next-button" onclick="nextPage()"></div>
</div>

    <script>
    /* é¡¯ç¤ºé¸æ“‡è‡‰éƒ¨ */
      window.onload = function() {
    let selectedFace = localStorage.getItem('selectedFace');
    if (selectedFace) {
        let faceImg = document.createElement('img');
        faceImg.src = selectedFace;
        faceImg.classList.add('selected-image');
        faceImg.style.zIndex = 1;
        faceImg.style.transform = 'scale(3)'; // æ”¾å¤§ 300%
        document.getElementById('displayBox').appendChild(faceImg);
    }
};

    /* é¡¯ç¤ºé¸æ“‡çœ‰æ¯› */   
function selectBrow(imageSrc) {
    // ç§»é™¤èˆŠçš„çœ‰æ¯›
    let existingBrow = document.getElementById('browLayer');
    let existingMirroredBrow = document.getElementById('mirroredBrowLayer');
    if (existingBrow) existingBrow.remove();
    if (existingMirroredBrow) existingMirroredBrow.remove();

    // å‰µå»ºæ–°çœ‰æ¯›ï¼ˆæ­£å¸¸æ–¹å‘ï¼‰
    let browImg = document.createElement('img');
    browImg.src = imageSrc;
    browImg.classList.add('selected-image');
    browImg.style.position = 'absolute';
    browImg.style.top = '450px';
    browImg.style.left = '435px'; // å³é‚Šçœ‰æ¯›
    browImg.style.zIndex = 2;
    browImg.id = 'browLayer';
    document.getElementById('displayBox').appendChild(browImg);

    // å‰µå»ºé¡åƒçœ‰æ¯›
    let mirroredBrow = document.createElement('img');
    mirroredBrow.src = imageSrc;
    mirroredBrow.classList.add('selected-image', 'mirrored');
    mirroredBrow.style.position = 'absolute';
    mirroredBrow.style.top = '450px';
    mirroredBrow.style.left = '205px'; // å·¦é‚Šçœ‰æ¯›
    mirroredBrow.style.transform = 'scaleX(-1)'; // æ°´å¹³ç¿»è½‰
    mirroredBrow.style.zIndex = 2;
    mirroredBrow.id = 'mirroredBrowLayer';
    document.getElementById('displayBox').appendChild(mirroredBrow);

    // å„²å­˜é¸æ“‡çš„çœ‰æ¯›
    localStorage.setItem('selectedBrow', imageSrc);
}
   // çœ‰æ¯›å¾®èª¿å™¨
 function adjustBrow(type, value) {
    let brow = document.getElementById('browLayer');
    let mirroredBrow = document.getElementById('mirroredBrowLayer');
    if (!brow || !mirroredBrow) return;
    if (type === 'rotate') {
        let currentRotation = parseInt(brow.dataset.rotation || 0);
        let newRotation = currentRotation + value;
        brow.style.transform = `rotate(${newRotation}deg)`;
        mirroredBrow.style.transform = `scaleX(-1) rotate(${newRotation}deg)`;
        brow.dataset.rotation = newRotation;
        mirroredBrow.dataset.rotation = newRotation;
    } else if (type === 'vertical') {
        brow.style.top = `${parseInt(brow.style.top) + value}px`;
        mirroredBrow.style.top = `${parseInt(mirroredBrow.style.top) + value}px`;
    } else if (type === 'horizontal') {
        brow.style.left = `${parseInt(brow.style.left) + value}px`;
        mirroredBrow.style.left = `${parseInt(mirroredBrow.style.left) - value}px`;
    }
}

let initialState = {
        rotate: 0,
        vertical: 450,
        horizontal: 355
    };
    function resetBrow() {
        let brow = document.getElementById('browLayer');
        let mirroredBrow = document.getElementById('mirroredBrowLayer');
        if (!brow || !mirroredBrow) return;

        brow.style.transform = `rotate(${initialState.rotate}deg)`;
        mirroredBrow.style.transform = `scaleX(-1) rotate(${initialState.rotate}deg)`;

        brow.style.top = `${initialState.vertical}px`;
        mirroredBrow.style.top = `${initialState.vertical}px`;

        brow.style.left = `${initialState.horizontal}px`;
        mirroredBrow.style.left = `${130}px`; // å·¦é‚Šçœ‰æ¯›å°ç¨±ä½ç½®
    }

function nextPage() {
    const selectedFace = document.querySelector('.selected-image'); // å–å¾—é¸æ“‡çš„è‡‰
    const selectedBrow = document.getElementById('browLayer'); // å–å¾—é¸æ“‡çš„çœ‰æ¯›

    if (selectedFace) {
        localStorage.setItem('selectedFace', selectedFace.src); // å„²å­˜è‡‰éƒ¨åœ–ç‰‡
    }

    if (selectedBrow) {
        localStorage.setItem('selectedBrow', selectedBrow.src); // å„²å­˜çœ‰æ¯›åœ–ç‰‡
        localStorage.setItem('browPositionTop', selectedBrow.style.top); // å„²å­˜çœ‰æ¯›çš„å‚ç›´ä½ç½®
        localStorage.setItem('browPositionLeft', selectedBrow.style.left); // å„²å­˜çœ‰æ¯›çš„æ°´å¹³ä½ç½®
        localStorage.setItem('browRotation', selectedBrow.dataset.rotation || 0); // å„²å­˜çœ‰æ¯›çš„æ—‹è½‰è§’åº¦
    }

    window.location.href = 'question3.html'; // è·³è½‰åˆ°ç¬¬ä¸‰é 
}

    </script>
</body>
</html>
